## 🎯 [ User ID controlled by request parameter](https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter)

### 📝 **الوصف**
> اللاب فيه ثغرة تصعيد امتياز أفقي (Horizontal privilege escalation / IDOR) على صفحة حساب المستخدم. الخادم يعرض معلومات حساب أي مستخدم إذا تم تغيير باراميتر الـID في الطلب، دون التحقق من ملكية المورد. هدفك: الحصول على **API key** للمستخدم **carlos** ثم تسليمها كحل.
---
### 🔍 **الاكتشاف**
* عند عرض صفحة حسابك (`wiener`)، الصفحة تستدعي endpoint يعتمِد على باراميتر يحدد أي حساب يُعرض (مثل `id` أو `user`).
* نفس الـendpoint يقبل قيم مختلفة؛ بتغيير القيمة للـid/username ممكن عرض صفحة حساب مستخدم آخر (مثل `carlos`) إذا لم يكن هناك تحقق على الخادم يؤكد أن الحساب تابع للمستخدم الحالي.

---
### 🛠️ **خطوات الحل (منهجية، تطبيقية، خطوة بخطوة)**

   * افتح المتصفح في صفحه التسجيل ودخل: `wiener:peter`.
	   * `https://0ad100860445b9de822cbf64006f00ab.web-security-academy.net/my-account?id=wiener`
		   * ![[photo/Screenshot From 2025-10-17 15-42-07.png]]
	   * `https://0ad100860445b9de822cbf64006f00ab.web-security-academy.net/my-account?id=carlos`
		   * ![[Screenshot From 2025-10-17 15-45-43.png]]

---

🔑 **النقاط المستفادة**

1. لا تعتمد على عدم ظهور رابط أو زر في الواجهة الأمامية لحماية الموارد — **التحقق يجب أن يتم على الخادم** (server-side authorization).
2. تمرير معرفات مباشرة من العميل للمورد (IDOR) خطير؛ يجب التحقق من ملكية المورد قبل عرضه أو تعديله.
3. استخدم مراجع غير مباشرة أو تحقق ملكية/دور قبل إرجاع أي بيانات حساسة (مثل مفاتيح API).
---