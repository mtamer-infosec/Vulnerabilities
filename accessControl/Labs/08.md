##  [Method-based access control can be circumvented](https://portswigger.net/web-security/access-control/lab-method-based-access-control-can-be-circumvented)

### 🎯 الوصف

التطبيق ينفّذ تحكمًا في الوصول جزئيًا اعتمادًا على **طريقة HTTP** (HTTP method). الواجهة الأمامية تمنع أو تخفي بعض الإجراءات اعتمادًا على الطريقة (مثل السماح فقط بـPOST لمسارات إدارية)، لكن الخادم يقبل نفس الإجراء عبر طريقة أخرى أو يتعامل مع طرق غير متوقعة، مما يتيح تجاوزًا للتحكم في الوصول.

---

### 🔍 الاكتشاف (موجز)

* عند فحص طلبات لوحة الإدارة كـ`administrator:admin` تم تسجيل طلب (endpoint + method) مسؤول عن ترقية حسابات المستخدمين.
* باستخدام حساب المستخدم `wiener:peter`، تم التحقق من أن نفس الـendpoint يمكن استدعاؤه بطرائق HTTP مختلفة (أو أن الخادم لا يرفض طرقًا غير متوقعة) مما سمح بتنفيذ عملية الترقية دون تحقق كافٍ من التفويض على الخادم.
* النتيجة: استطعنا الترويج إلى دور المشرف (administrator) بتجاوز قيود الواجهة الأمامية.

---

### 🛠️ خطوات الاستدلال (ملخّصة، دون شرح استغلال تفصيلي)

1. تسجيل الدخول كـ`administrator:admin` ومراقبة طلبات لوحة الإدارة لتحديد endpoint وHTTP method المستخدمين للعمليات الإدارية.
2. بعدين تعمل `Upgrades ل carlos`
![[Screenshot From 2025-10-17 16-44-45 1.png]]

3. تسجيل الدخول كـ`wiener:peter` 
	 ![[Screenshot From 2025-10-17 16-45-47.png]]


4. تضيف الطلب بتاع  `admin-roles` , `id=wiener`  في **Repeater** وتفتح `/admin-roles`
![[Screenshot From 2025-10-17 16-57-45.png]]


5. بعدين تغير `session`  من 
![[Screenshot From 2025-10-17 16-46-56.png]]
 الي
 ![[Screenshot From 2025-10-17 16-47-03.png]] 
بتاع `wiener`


6. بعدين تغير ال  `request`
![[Screenshot From 2025-10-17 16-47-36.png]]
7. بعدين غير اسم ال `user` من 
![[Screenshot From 2025-10-17 16-48-00.png]]

الي  `wiener`

![[Screenshot From 2025-10-17 16-38-14 1.png]]
8. واخر حاجه اعمل ارسال و الحمد لله اللاب اتحل ✅
---

### 💡 خلاصة قصيرة

السبب الرئيس للفشل هو الاعتماد على الفحص في الطبقة الأمامية أو التحقق الجزئي (مثلاً عبر الـUI أو route rules فقط) بدلاً من فرض قواعد تفويض صارمة على الخادم. الحلّ العملي: تحقق دائمًا على الخادم ورفض الطرق غير المرغوب فيها.

---
