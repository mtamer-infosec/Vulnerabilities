## [User ID controlled by request parameter with data leakage in redirect](https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect)
### ๐ ุงููุตู

> ูุญุชูู ูุฐุง ุงููุฎุชุจุฑ ุนูู ุซุบุฑุฉ ูู ุงูุชุญูู ูู ุงููุตูู ุญูุซ ูุชู ุชุณุฑูุจ ูุนูููุงุช ุญุณุงุณุฉ ุฏุงุฎู ุฌุณู ุงุณุชุฌุงุจุฉ ุฅุนุงุฏุฉ ุงูุชูุฌูู (redirect). ูุญู ุงูููุงุจุ ุนููู ุงูุญุตูู ุนูู **ููุชุงุญ API** ูููุณุชุฎุฏู **carlos** ูุฅุฑุณุงูู ูุญู.

ููููู ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู: `wiener:peter`.

---

### ๐ ุงูุงูุชุดุงู

- ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู ููุณุชุฎุฏู ุนุงุฏู (`wiener`)ุ ุชูุฌุฏ ููุงุท ููุงูุฉ (endpoints) ุชุชุนุงูู ูุน ูุนุฑูู ุงููุณุชุฎุฏู (user id) ูู ูุนุทูุงุช ุงูุทูุจ (request parameter) ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู ุงูุฌูุณุฉ/ุงููtoken.
    
- ุชุบููุฑ ูููุฉ ูุนุฑูู ุงููุณุชุฎุฏู ูู ุงูุทูุจ ูุณูุญ ูููุชููู ุจุงููุตูู ุฅูู ุจูุงูุงุช ูุณุชุฎุฏููู ุขุฎุฑูู (IDOR).
    
---

### ๐๏ธ ุฎุทูุงุช ุงูุญู (ุฎุทูุงุช ุนูููุฉ ูุฑุชูุจุฉ)

> ููุงุญุธุฉ: ุณูุณุชุฎุฏู ุฃุฏูุงุช ุงูุงุนุชุฑุงุถ (interception) ูุซู Burp Proxy ุฃู ุฃู ุฃุฏุงุฉ ูุงุฏุฑุฉ ุนูู ุชุนุฏูู ุงูุทูุจุงุช ููุชุงุจุนุฉ ุงูุงุณุชุฌุงุจุงุช.

1. ุณุฌูู ุฏุฎููู ุฅูู ุงูุชุทุจูู ุจุงุณุชุฎุฏุงู ุญุณุงุจ `wiener:peter` ูู ูุงุฌูุฉ ุงูููุจ.
    
2. ุงูุชุญ Burp Proxy (ุฃู ุฃู ุฃุฏุงุฉ interception) ููุนูู ุงุนุชุฑุงุถ ุงูุทูุจุงุช (intercept).
    
3. ูููุฐ ุฅุฌุฑุงุกู ูุคุฏู ุฅูู ุฅุฑุณุงู ุทูุจ ูุญุชูู ุนูู ูุนุฑูู ุงููุณุชุฎุฏู โ ูุซุงู ุดุงุฆุน: ุฒูุงุฑุฉ ุตูุญุฉ ุงูููู ุงูุดุฎุตู ุฃู ุฃู endpoint ูุฃุฎุฐ `id` ุฃู `user` ูู ุงูู query string ุฃู body.
    5. ![[Screenshot From 2025-10-17 19-32-41.png]]
4. ุนูุฏูุง ูุนุชุฑุถ Burp ุงูุทูุจุ **ุบููุฑ ูููุฉ ูุนุฑูู ุงููุณุชุฎุฏู ุฅูู `carlos`** (ุฃู ุฃู ูููุฉ ุชุดูุฑ ูููุณุชุฎุฏู ุงููุณุชูุฏู) ุจุฏูุงู ูู `wiener` ุฃู ุงููููุฉ ุงูุฃุตููุฉ.. 
![[Screenshot From 2025-10-17 19-34-14.png]]

---------------------

