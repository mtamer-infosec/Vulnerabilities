## [User ID controlled by request parameter with data leakage in redirect](https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect)
### 📝 الوصف

> يحتوي هذا المختبر على ثغرة في التحكم في الوصول حيث يتم تسريب معلومات حساسة داخل جسم استجابة إعادة التوجيه (redirect). لحل اللّاب، عليك الحصول على **مفتاح API** للمستخدم **carlos** وإرساله كحل.

يمكنك تسجيل الدخول باستخدام: `wiener:peter`.

---

### 🔍 الاكتشاف

- عند تسجيل الدخول كمستخدم عادي (`wiener`)، توجد نقاط نهاية (endpoints) تتعامل مع معرّف المستخدم (user id) من معطيات الطلب (request parameter) بدلاً من الاعتماد على الجلسة/الـtoken.
    
- تغيير قيمة معرّف المستخدم في الطلب يسمح للمتّهم بالوصول إلى بيانات مستخدمين آخرين (IDOR).
    
---

### 🛠️ خطوات الحل (خطوات عملية مرتّبة)

> ملاحظة: سنستخدم أدوات الاعتراض (interception) مثل Burp Proxy أو أي أداة قادرة على تعديل الطلبات ومتابعة الاستجابات.

1. سجّل دخولك إلى التطبيق باستخدام حساب `wiener:peter` من واجهة الويب.
    
2. افتح Burp Proxy (أو أي أداة interception) وفعّل اعتراض الطلبات (intercept).
    
3. نفّذ إجراءً يؤدي إلى إرسال طلب يحتوي على معرّف المستخدم — مثال شائع: زيارة صفحة الملف الشخصي أو أي endpoint يأخذ `id` أو `user` في الـ query string أو body.
    5. ![[Screenshot From 2025-10-17 19-32-41.png]]
4. عندما يعترض Burp الطلب، **غيّر قيمة معرّف المستخدم إلى `carlos`** (أو أي قيمة تشير للمستخدم المستهدف) بدلاً من `wiener` أو القيمة الأصلية.. 
![[Screenshot From 2025-10-17 19-34-14.png]]

---------------------

