# [Password brute-force via password change](https://portswigger.net/web-security/authentication/other-mechanisms/lab-password-brute-force-via-password-change)


> **الهدف**: استغلال ضعف في خاصية تغيير كلمة المرور لعمل brute‑force على حساب `carlos` ثم الدخول لصفحته "My account".

---

## 1) الفكرة بسرعة

بعض التطبيقات تسمح للمستخدم بتبديل كلمة المرور عن طريق إرسال حقل `current-password` مع `new-password-1` و`new-password-2`. لو التطبيق لا يتحقق جيدًا أن `current-password` يخص مالك الحساب أو لا يقيّد محاولات التحقق، يمكن استغلال هذه الواجهة كـ نقطة لاختبار كلمات المرور (brute‑force) على حساب مستخدم مُحدد.

في هذا المختبر استعملت حساب (`wiener`) للحصول على قالب الطلب، ثم عدّلت الحقل `username` إلى `carlos` وجرّبت كلمات من `candidate passwords` في مكان `current-password` حتى وجدت الكلمة الصحيحة.
![[photo/Screenshot From 2025-10-26 22-13-23.png]]

---

## 2) الخطوات

1. **تحضير القالب**
    
    - سجّل دخول بحساب (`wiener:peter`) واذهب لصفحة تغيير كلمة المرور.
        
    - في Burp سجل الطلب الذي يُرسَل عند تغيير الباسورد (POST) وأرسله إلى **Intruder**.
        
2. **تحديد المواضع (Positions)**
    
    - حدِّد : `current-password`
        
    - عادة تحتاج تغيّر `username` إلى `carlos`  وتجعل `current-password` هو الـ payload .
        ![[photo/Screenshot From 2025-10-27 20-55-56.png]]
1. **إعداد الـ Payloads**
    
    - Payload : `candidate passwords` 
        
    - اترك `new-password-1/2` بكلمة ثابتة تحبّ تستخدمها بعد نجاح الهجوم (مثلاً `peter123`) — هذه ستكون كلمة المرور النهائية لو نجح الهجوم.
        
2. **تشغيل الهجوم وقراءة النتائج**
    
    - شغّل الهجوم وراقب الأعمدة: `Status`, `Length`, `Location`، أو أي مؤشر يدل على نجاح العملية (مثلاً redirect إلى صفحة الحساب أو نص "Password changed").
        
    - قم بفرز النتائج حسب `Length` أو راجع أي استجابة تختلف عن الباقي.
        
3. **التحقق النهائي**
    
    - عند العثور على كلمة مرشّحة، استخدمها يدوياً في Repeater  لتأكيد أن السيرفر قبلها وأصبح `new-password` فعالًا.
        
    - بعد التأكيد سجل دخول باسم `carlos` وكلمة `new-password-1` التي اخترتها لتثبت الحل.
        

---

## 3) مثال قالب الطلب (Form-urlencoded)

```
POST /change-password HTTP/1.1
Host: target.lab
Content-Type: application/x-www-form-urlencoded

username=wiener&current-password=peter&new-password-1=main&new-password-2=main
```

غيّر `username=wiener` إلى `username=carlos`، وضع `peter` كموضع الـ payload.

---
