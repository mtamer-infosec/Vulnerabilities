# [Username enumeration via response timing ](https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-response-timing)

> **Goal**: استخرج اسم مستخدم صحيح عن طريق قياس فارق زمن الاستجابة، بعدها فك كلمة المرور وادخل على صفحة الحساب.

---

## 1) ملخص الفكرة 

- بعض التطبيقات ترد بشكل أسرع عندما يكون "اليوزر" غير موجود، أو أبطأ عندما تكون عملية تحقق إضافية تحدث (مثلاً مقارنة طويلة أو عملية داخلية).
    
- نغيّر طول كلمة المرور أو نغيّر حقول في الطلب لتُجري الخادم عمليات مختلفة وتظهر فرق زمني يمكن قياسه.
    
- نرسل سلسلة طلبات منظمة على لستة يوزرات ونقيس زمن الاستجابة، المستخدم الذي يُظهر **زمن أطول** غالباً هو المستخدم الحقيقي.
    

---

## 2) خطوات العمل المرتبة (لـ Burp Suite — ما طبقته انت)

1. **تحضير الطلب**
    
    - افتح **Repeater** وخُذ طلب تسجيل الدخول الافتراضي (POST) الذي أرسله المتصفح.
        
    - عرِّف الحقول: `username`, `password`، وأي رؤوس (Headers) مثل `X-Forwarded-For` إن احتجت تتجاوز حظر IP.
        
2. **تجربة في Repeater**
    
    - اجعل قيمة كلمة المرور كبيرة وطويلة (مثلاً 1000 حرف) ولاحظ زمن الاستجابة — إذا زاد الزمن فقد يكون الخادم يقوم بعملية تحقق إضافية.
        
3. **نقل إلى Intruder**
    
    - ضع مواضع الـ payload (مثلاً مكان اسم المستخدم و آخر رقم في `X-Forwarded-For:` ip 
        
    - اختر نوع الهجوم **Sniper** عندما تختبر يوذر واحد في كل مرة، أو **Pitchfork** عندما تريد تغيير عدة حقول متزامنة (مثلاً ايبي متغير + يوزر متغير).
        ![[photo/Screenshot From 2025-10-18 21-25-40.png]]
        
1. **إعداد Payloads**

    ![[photo/Screenshot From 2025-10-18 21-05-45.png]]
    - Payload set A: قائمة اليوزرات المرشَّحة (التي أعطاكها التطبيق أو خزنتها من أماكن أخرى).
        
    - Payload set B (اختياري، لو بتغيّر IP): سلسلة أرقام لآخر بايت في `X-Forwarded-For` من 1..200
        
    - Payload type: `Numbers` لو بتغيّر الأرقام، أو `Simple list` لليوزرات.
        
2. **تشغيل الهجوم وقراءة النتائج**
    
    - رتِّب النتائج بحسب `Response time` (أو export ثم فرز).
        
    - ابحث عن صف واحد/قليل يظهر **وقت استجابة أطول بوضوح** عن الباقي — هذا مرشح لكونه يوزر صحيح.
        
3. **التحقق**
    
    - خُذ الطلب لذلك اليوزر المرشّح وحوّله إلى **Intruder** مجدداً لكن هذه المرة اجعل الـ payloads كلمات مرور من قائمة (wordlist) أو استخدم تغيّر بالطول حتى تصل لأقل طول يقبل.
        
    - راقب رسائل الاستجابة (مثلاً تغير في المحتوى أو redirect أو صفحة الحساب تظهر).
        
4. **حلّ المختبر**
    
    - عندما تجد كلمة مرور صحيحة تستطيع الولوج ثم تفتح صفحة `Account` أو ما يطلبه الـ lab وتنجز المهمة.
        

---

## 3) نصائح عملية ومحسّنات 
- **تجنّب الحظر**: استخدم `X-Forwarded-For` أو بروكسيات متعددة لو يُحظر IP بسرعة.

---

## 6) أدوات خارجية تقصر عليك الشغل (سريعة، مع لمحة عن كل واحدة)

- **Burp Suite Intruder / Repeater** — عمليتك الأساسية (أنت استخدمتها فعلاً).
    
- **ffuf / wfuzz** — أدوات مسح وفَرْز (fuzzing) سريعة؛ يمكن استخدامها لطلبات متزامنة وقياس الاستجابة.
    
- **Hydra / Medusa / Ncrack** — أدوات brute-force لكلمات المرور عبر بروتوكولات متعددة (HTTP form-based تحتاج إعدادات إضافية).
    
- **Python (requests + asyncio / threading)** — مرنة جداً لقياس الزمن، تكرار التجارب، وتصدير النتائج.
    

---

## 7) أخطاء شائعة وطرق تجنبها

- الاعتماد على فرق زمن ضئيل جداً (خلي الفرق واضح ومتكرر).
    
- عدم تكرار القياس (مرات متعددة لتقليل خطأ الشبكة).
    
- تجاهل تأثير الـ CDN أو WAF الذي قد يعيد ترتيب أو يعطّل السلوك.
    

---
