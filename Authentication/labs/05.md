# [Username enumeration via account lock](https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-account-lock)

> **الهدف**: اكتشاف اسم مستخدم صحيح باستغلال خلل منطقى في خاصية قفل الحساب (account lock). بعد اكتشاف اليوزر الصحيح، نفك كلمة المرور ونفتح صفحة الحساب.

---

## 1) ملخص الفكرة

التطبيق بيعمل قفل (lock) للحساب بعد عدد من محاولات تسجيل الدخول الخاطئة. الخلل هنا إننا نقدر نجبر التطبيق إنّه يطبق قفل على بعض الحسابات (أو يميّز بينها) ونعرف أي اسم مستخدم يُسبّب قفلًا — هذا يعني أنّ ذلك اليوزر موجود فعلاً. باختصار: نبني هجوم يسبب "حظر" لبعض اليوزرات ثم نرصد أيه اللي اتقفل.

---

## 2) الخطوات 

1. **التقاط طلب تسجيل الدخول (Login POST)**
   * ثم أرسله إلى **Intruder**.

2. **تحضير Positions**

   * علّم حقل الـ `username` كـ position.
   * علّم حقل الـ `password` كـ position أيضًا.لاكن متعلمش علي ال password لا علم جمب اي كلمه ويكون فاضي 
![[photo/Screenshot From 2025-10-20 21-26-36.png]]
3. **نوع الهجوم — Cluster Bomb**
4. **إعداد Payloads لخطوة الاكتشاف (Enumeration)**

   * Payload set 1: قائمة اليوزرات المرشّحة (candidate usernames).
   * Payload set 2: قائمة خاصة تُستخدم لإحداث "أخطاء متعددة" على نفس الحساب — في الحالّة دي يمكن تستخدم قيمة `null` أو ترك الباسورد فارغاً، وتولّدها بعدة مرات (مثلاً `generate 5`) حتى تُخرِج 5 محاولات خاطئة لكل يوزر.

     * في Burp: ضع في Payload set 2 قيمة واحدة ثم اختَر `Null payloads` وتحديد `Generate` على 5 (أو عدد المحاولات اللازمة لإحداث القفل).

5. **تشغيل الهجوم وملاحظة السلوك**

   * شغّل الـ attack.
   * ابحث عن الـ responses التي تُشير إلى أن الحساب اتقفل (قد تكون رسالة نصية في الصفحة، أو HTTP status مختلف، أو redirect، أو اختلاف في طول الرد).
   * اليوزر الذي يظهر عليه أثر القفل هو مرشح أن يكون اسم مستخدم صالح.

6. **التحقق**

   * خُذ اليوزر المرشح وأرسله إلى Intruder مرة أخرى لكن الآن لا تستهدف القفل — استعمل قائمة كلمات مرور حقيقة (`passwords.txt`) وحاول brute-force.
   * راقب تغيُّر `length` أو `status` لتمييز المحاولة الناجحة.

7. **دخول الحساب**

   * بعد إيجاد كلمة المرور الصحيحة سجّل الدخول وافتح صفحة الحساب المطلوبة لإتمام التحدي.

---
