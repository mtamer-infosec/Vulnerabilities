# [ Broken brute-force protection, IP block](https://portswigger.net/web-security/authentication/password-based/lab-broken-bruteforce-protection-ip-block)

> **الهدف**: كسر الحماية الضعيفة ضد هجمات brute-force عبر منطق خاطئ: تنفيذ هجوم على كلمة المرور، تجاوز حظر الـ IP، وتسجيل الدخول ليوزر الضحية `carlos`.

---

## 2) الخطوات  

1. **جمع معلومات البداية**

   * يوزر المهاجم/المختبر: `wiener:peter` (مش بالضرورة مفيد هنا، لكن يكون عندك مرجع).
   * يوزر الضحية المستهدف: `carlos`.

2. **تحضير الطلب في Burp Repeater**

   * خُذ طلب تسجيل الدخول (POST) من المتصفح وانقله إلى **Repeater**.
   * إضافة  `127.0.0.1:X-Forwarded-For` 

3. **تحويل الطلب إلى Intruder**

   * في Intruder ضع المسار (Positions): علّم  `{password}`، وعلّم آخر جزء في ال ip  بتاع  `X-Forwarded-For` كموضع payload 
   ![[photo/Screenshot From 2025-10-20 15-21-47.png]]
   

4. **اختيار نوع الهجوم**

   * استخدم **Pitchfork** لو عايز تزوّد ثلاث قوائم (يوزر ثابت أو متغير، باسورد لائحة، وآخر رقم في IP).
   * استخدم **Sniper** لو بتجرب يوذر واحد مع كلمات مرور فقط.
   
5. **إعداد Payloads**
   * Payload set 1 (Password): جهّز قائمة كلمات (wordlist) أو كلمات مرشّحة.
   * Payload set 2 (IP last byte): `1..200` أو أي نطاق يحاكي تعدد عناوين.

6. **تشغيل الهجوم**
   * رتب النتائج بحسب **Length** أو **Response time** أو **Status code** — في هذا المختبر الطول قد يتغير عند النجاح.

7. **تسليم الحل**
	* تأكد إنك فعلاً قُدِرت تدخل على صفحة الحساب (Account) للـ `carlos`.
	* بعد التأكد افتح صفحة الحساب المطلوبة وأتم المهمة للمختبر.

---

## 3) لماذا عملت X-Forwarded-For؟

* المصادقة قد تكون مرتبطة بعنوان الـ IP، فبمجرد نجاح عدة محاولات من IP واحد يتم حظر ذلك الـ IP.
* بإضافة `X-Forwarded-For` وتغيير آخر بايت، تبدو الطلبات وكأنها آتية من عناوين مختلفة فتتجنب الحظر.
---
